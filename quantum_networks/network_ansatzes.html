<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Ansatz Library" href="ansatz_library.html" /><link rel="prev" title="Network Nodes" href="network_nodes.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.09.10 -->
        <title>Network Ansatzes - qNetVO</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/css/qnetvo.css?v=7312255b" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
    </div>
    <div class="header-center">
      <a href="../index.html">
        <div class="brand">qNetVO</div>
      </a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" style="padding-top: 1px;">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <div class="theme-toggle-container theme-toggle-header">
      	<button class="theme-toggle">
          <div class="visually-hidden">GitHub</div>
      	  <a href="https://github.com/ChitambarLab/qNetVO">
          <i class="fa fa-github" style="font-size:16px"></i></a>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/qnetvo_logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">qNetVO</span>
  
</a><div style="text-align: center;">
  <a href="https://github.com/ChitambarLab/qNetVO" style="text-align: center; font-size: 18px">
    <i class="fa fa-github" style="margin-right: 5px; font-size: 18px"></i>GitHub
  </a>
</div><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Quantum Networks</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Quantum Networks</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="network_nodes.html">Network Nodes</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Network Ansatzes</a></li>
<li class="toctree-l2"><a class="reference internal" href="ansatz_library.html">Ansatz Library</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cost/index.html">Cost Functions</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Cost Functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cost/qnodes.html">QNodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cost/linear_inequalities.html">Linear Cost Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cost/entropic_quantities.html">Entropic Quantities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cost/magic_squares_game.html">The Magic Squares Game</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cost/nonlocality_witnesses/index.html">Nonlocality Witnesses</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Nonlocality Witnesses</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../cost/nonlocality_witnesses/chsh_inequality.html">CHSH Inequality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cost/nonlocality_witnesses/I_3322_inequality.html">I-3322 Inequality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cost/nonlocality_witnesses/mermin_klyshko_inequality.html">Mermin-Klyshko Inequality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cost/nonlocality_witnesses/nlocal_chain_inequality.html">n-Local Chain Inequality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cost/nonlocality_witnesses/nlocal_star_inequality.html">n-Local Star Inequality</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../optimization.html">Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>

</div></div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" style="padding-top: 2px;">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <div class="theme-toggle-container theme-toggle-content">
	      	<button class="theme-toggle" style="padding-top: 1px;">
	          <div class="visually-hidden">GitHub</div>
	      	  <a href="https://github.com/ChitambarLab/qNetVO">
	          <i class="fa fa-github" style="font-size:16px"></i></a>
	        </button>
	      </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <div role="navigation" aria-label="breadcrumbs navigation">
  <ol class="breadcrumb">
    <li><a href="../index.html">Docs</a></li>
    
      <li><a href="index.html">Quantum Networks</a></li>
    
    <li>Network Ansatzes</li>
  </ol>
</div>
        <article role="main">
          <section id="network-ansatzes">
<h1>Network Ansatzes<a class="headerlink" href="#network-ansatzes" title="Permalink to this heading">#</a></h1>
<p>The quantum network ansatz is a collection of network nodes aggregated
into sequential layers ordered as prepare nodes, noise or processing nodes, and measure nodes.
It is important that all measurement nodes are in the final layer.
The nodes in each layer are independent and each operate upon a unique set of wires.
If two sequential nodes operate on the same wire, then one-way quantum communication
is sent from the first node to the second node.</p>
<dl class="py class">
<dt class="sig sig-object py" id="qnetvo.NetworkAnsatz">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qnetvo.</span></span><span class="sig-name descname"><span class="pre">NetworkAnsatz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dev_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qnetvo/network_ansatz.html#NetworkAnsatz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qnetvo.NetworkAnsatz" title="Permalink to this definition">#</a></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">NetworkAnsatz</span></code> class describes a parameterized quantum network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layers</strong> (list[list[<a class="reference internal" href="network_nodes.html#qnetvo.NetworkNode" title="qnetvo.NetworkNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">qnetvo.NetworkNode</span></code></a>]]) – Each layer represents a chronological step in the network simulation.
The nodes in each layer apply their operations in parallel where no two nodes can
operate on the same wire.</p></li>
<li><p><strong>dev_kwargs</strong> (<em>optional</em> dictionary) – Keyword arguments for the <a class="reference external" href="https://pennylane.readthedocs.io/en/stable/code/api/pennylane.device.html">pennylane.device</a> function.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An instantiated <code class="docutils literal notranslate"><span class="pre">NetworkAnsatz</span></code>.</p>
</dd>
</dl>
<p>There are some conventions that should be followed when defining network layers:</p>
<ol class="arabic simple">
<li><p>The first layer should contain all <a class="reference internal" href="network_nodes.html#qnetvo.PrepareNode" title="qnetvo.PrepareNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">qnetvo.PrepareNode</span></code></a> s in the network.</p></li>
<li><p>The last layer should contain all <a class="reference internal" href="network_nodes.html#qnetvo.MeasureNode" title="qnetvo.MeasureNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">qnetvo.MeasureNode</span></code></a> s in the network.</p></li>
<li><p>If classical communication is considered, then a <a class="reference internal" href="network_nodes.html#qnetvo.CCSenderNode" title="qnetvo.CCSenderNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">qnetvo.CCSenderNode</span></code></a> must be used
to obtain the communicated values in a layer preceding the layers where <a class="reference internal" href="network_nodes.html#qnetvo.CCReceiverNode" title="qnetvo.CCReceiverNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">qnetvo.CCReceiverNode</span></code></a> s
consume the classical communication.</p></li>
</ol>
<p>ATTRIBUTES:</p>
<ul class="simple">
<li><p><strong>layers</strong> - <code class="docutils literal notranslate"><span class="pre">list[list[NetworkNode]]</span></code>, The input layers of network nodes.</p></li>
<li><p><strong>layers_wires</strong> - <code class="docutils literal notranslate"><span class="pre">list[qml.wires.Wires]</span></code>, The wires used for each layer.</p></li>
<li><p><strong>layers_cc_wires_in</strong> - <code class="docutils literal notranslate"><span class="pre">list[qml.wires.Wires]</span></code>, The classical communication wires input to each network layer.</p></li>
<li><p><strong>layers_cc_wires_out</strong> - <code class="docutils literal notranslate"><span class="pre">list[qml.wires.Wires]</span></code>, The classical communication wires output from each network layer.</p></li>
<li><p><strong>layers_num_settings</strong> - <code class="docutils literal notranslate"><span class="pre">list[int]</span></code>, The number of setting used in each layer.</p></li>
<li><p><strong>layers_total_num_in</strong> - <code class="docutils literal notranslate"><span class="pre">list[int]</span></code>, The total number of inputs for each layer.</p></li>
<li><p><strong>layers_node_num_in</strong> - <code class="docutils literal notranslate"><span class="pre">list[list[int]]</span></code>, The number of inputs for each node in the layer.</p></li>
<li><p><strong>layers_num_nodes</strong> - <code class="docutils literal notranslate"><span class="pre">list[int]</span></code>, The number of nodes in each layer.</p></li>
<li><p><strong>network_wires</strong> - The list of wires used by the network ansatz.</p></li>
<li><p><strong>network_cc_wires</strong> - The list of classical communication wires in the network.</p></li>
<li><p><strong>num_cc_wires</strong> - The number of classical communication wires.</p></li>
<li><dl class="simple">
<dt><strong>dev_kwargs</strong> - <em>mutable</em>, the keyword args to pass to the <a class="reference external" href="https://pennylane.readthedocs.io/en/stable/code/api/pennylane.device.html">pennylane.device</a> function.</dt><dd><p>If no <code class="docutils literal notranslate"><span class="pre">dev_kwargs</span></code> are provided, a <code class="docutils literal notranslate"><span class="pre">&quot;default.qubit&quot;</span></code> is constructed for
noiseless networks.</p>
</dd>
</dl>
</li>
<li><p><strong>fn</strong> (<em>function</em>) - A quantum function implementing the quantum network ansatz.</p></li>
<li><dl class="simple">
<dt><strong>parameter_partitions</strong> (<em>List[List[List[Tuple]]]</em>) - A ragged array containing tuples that specify</dt><dd><p>how to partition a 1D array of network settings into the subset of settings
passed to the qnode simulating the network. See
<a class="reference internal" href="#qnetvo.NetworkAnsatz.get_network_parameter_partitions" title="qnetvo.NetworkAnsatz.get_network_parameter_partitions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_network_parameter_partitions()</span></code></a> for details.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – If the <code class="docutils literal notranslate"><span class="pre">wires</span></code> are not unique across all nodes in an ansatz layer or the <code class="docutils literal notranslate"><span class="pre">cc_wires_out</span></code> are not unique across all layers.</p></li>
<li><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">cc_wires_in</span></code> are used by a layer preceding the classical values output onto <code class="docutils literal notranslate"><span class="pre">cc_wires_out</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qnetvo.NetworkAnsatz.check_cc_causal_structure">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">check_cc_causal_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cc_wires_in_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc_wires_out_layers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qnetvo/network_ansatz.html#NetworkAnsatz.check_cc_causal_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qnetvo.NetworkAnsatz.check_cc_causal_structure" title="Permalink to this definition">#</a></dt>
<dd><p>Verifies that the classical communication is causal.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">cc_wires_out</span></code> describes the classical communication senders while <code class="docutils literal notranslate"><span class="pre">cc_wires_in</span></code> describe
classical communication receivers.
All network ansatzes must have a causal structure where nodes output their classical communication in
layers that precede the nodes that use that classical communication.</p>
<dl class="field-list simple">
<dt class="field-odd">Params cc_wires_in_layers<span class="colon">:</span></dt>
<dd class="field-odd"><p>The classical communication input wires, <code class="docutils literal notranslate"><span class="pre">cc_wires_in</span></code>, considered for each layer.</p>
</dd>
<dt class="field-even">Params cc_wires_out_layers<span class="colon">:</span></dt>
<dd class="field-even"><p>The classical communication output wires, <code class="docutils literal notranslate"><span class="pre">cc_wires_out</span></code>, considered for each layer.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">cc_wires_in</span></code> are used by a layer preceding the classical values output onto <code class="docutils literal notranslate"><span class="pre">cc_wires_out</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qnetvo.NetworkAnsatz.circuit_layer_fn">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">circuit_layer_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_nodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qnetvo/network_ansatz.html#NetworkAnsatz.circuit_layer_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qnetvo.NetworkAnsatz.circuit_layer_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Constructs a quantum function for an ansatz layer of provided network nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>layer_nodes</strong> (list[<a class="reference internal" href="network_nodes.html#qnetvo.NetworkNode" title="qnetvo.NetworkNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">qnetvo.NetworkNode</span></code></a>]) – A list of nodes in a network layer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A quantum function evaluated as <code class="docutils literal notranslate"><span class="pre">circuit_layer(settings)</span></code> where <code class="docutils literal notranslate"><span class="pre">settings</span></code>
is an array constructed via the <code class="docutils literal notranslate"><span class="pre">layer_settings</span></code> function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qnetvo.NetworkAnsatz.collect_wires">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_wires</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wires_lists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qnetvo/network_ansatz.html#NetworkAnsatz.collect_wires"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qnetvo.NetworkAnsatz.collect_wires" title="Permalink to this definition">#</a></dt>
<dd><p>A helper method for the <code class="docutils literal notranslate"><span class="pre">NetworkAnsatz</span></code> class which collects and aggregates the
wires from a set of collection of network nodes (<code class="docutils literal notranslate"><span class="pre">prepare_nodes</span></code> or <code class="docutils literal notranslate"><span class="pre">measure_nodes</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>network_nodes</strong> (<em>list</em><em>[</em><a class="reference internal" href="network_nodes.html#qnetvo.PrepareNode" title="qnetvo.PrepareNode"><em>PrepareNode</em></a><em> or </em><a class="reference internal" href="network_nodes.html#qnetvo.MeasureNode" title="qnetvo.MeasureNode"><em>MeasureNode</em></a><em>]</em>) – A list consisting of either <code class="docutils literal notranslate"><span class="pre">PrepareNode</span></code>’s or <code class="docutils literal notranslate"><span class="pre">MeasureNode</span></code>’s.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the same wire is used in two different nodes in <code class="docutils literal notranslate"><span class="pre">network_nodes</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qnetvo.NetworkAnsatz.expand_qnode_settings">
<span class="sig-name descname"><span class="pre">expand_qnode_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qn_settings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network_inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qnetvo/network_ansatz.html#NetworkAnsatz.expand_qnode_settings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qnetvo.NetworkAnsatz.expand_qnode_settings" title="Permalink to this definition">#</a></dt>
<dd><p>Constructs network settings from qnode settings and the network inputs.</p>
<p>This implements the reverse mapping implemented in <a class="reference internal" href="#qnetvo.NetworkAnsatz.qnode_settings" title="qnetvo.NetworkAnsatz.qnode_settings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">qnetvo.NetworkAnsatz.qnode_settings()</span></code></a>.
Since there are fewer qnode settings than network settings, empty elements in the returned
list are set to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qn_settings</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Settings to pass to the network qnode.</p></li>
<li><p><strong>network_inputs</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – The considered classical network inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The network settings</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qnetvo.NetworkAnsatz.get_network_parameter_partitions">
<span class="sig-name descname"><span class="pre">get_network_parameter_partitions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qnetvo/network_ansatz.html#NetworkAnsatz.get_network_parameter_partitions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qnetvo.NetworkAnsatz.get_network_parameter_partitions" title="Permalink to this definition">#</a></dt>
<dd><p>A nested list containing tuples that specify how to partition a 1D array
of network settings into the subset of settings passed to the qnode simulating
the network. Each tuple <code class="docutils literal notranslate"><span class="pre">(start_id,</span> <span class="pre">stop_id)</span></code> is indexed by <code class="docutils literal notranslate"><span class="pre">layer_id</span></code>,
<code class="docutils literal notranslate"><span class="pre">node_id</span></code>, and classical <code class="docutils literal notranslate"><span class="pre">input_id</span></code> as
<code class="docutils literal notranslate"><span class="pre">parameter_partitions[layer_id][node_id][input_id]</span> <span class="pre">=&gt;</span> <span class="pre">(start_id,</span> <span class="pre">stop_id)</span></code>.
The <code class="docutils literal notranslate"><span class="pre">start_id</span></code> and <code class="docutils literal notranslate"><span class="pre">stop_id</span></code> describe the slice <code class="docutils literal notranslate"><span class="pre">network_settings[start_id:stop_id]</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qnetvo.NetworkAnsatz.layer_settings">
<span class="sig-name descname"><span class="pre">layer_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_settings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qnetvo/network_ansatz.html#NetworkAnsatz.layer_settings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qnetvo.NetworkAnsatz.layer_settings" title="Permalink to this definition">#</a></dt>
<dd><p>Constructs the list of settings for a circuit layer in the network ansatz.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network_settings</strong> (<em>List</em><em>[</em><em>Float</em><em>]</em>) – A list containing the circuit settings for each node
in the network.</p></li>
<li><p><strong>layer_id</strong> (<em>Int</em>) – The id for the targeted layer.</p></li>
<li><p><strong>layer_inputs</strong> (<em>List</em><em>[</em><em>Int</em><em>]</em>) – A list of the classical inputs supplied to each network node.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D array of settings for the circuit layer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qnetvo.NetworkAnsatz.qnode_settings">
<span class="sig-name descname"><span class="pre">qnode_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_settings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network_inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qnetvo/network_ansatz.html#NetworkAnsatz.qnode_settings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qnetvo.NetworkAnsatz.qnode_settings" title="Permalink to this definition">#</a></dt>
<dd><p>Constructs a list of settings to pass to the qnode executing the network ansatz.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network_settings</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>np.ndarray</em><em>]</em><em>]</em>) – The settings for the network ansatz scenario.</p></li>
<li><p><strong>network_inputs</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em>) – The classical inputs passed to each network node.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of settings to pass to the constructed qnode.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qnetvo.NetworkAnsatz.rand_network_settings">
<span class="sig-name descname"><span class="pre">rand_network_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fixed_setting_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qnetvo/network_ansatz.html#NetworkAnsatz.rand_network_settings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qnetvo.NetworkAnsatz.rand_network_settings" title="Permalink to this definition">#</a></dt>
<dd><p>Creates an array of randomized differentiable settings for the network ansatz.
If fixed settings are specified, then they are marked as <code class="docutils literal notranslate"><span class="pre">requires_grad=False</span></code> and
not differentatiated during optimzation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fixed_setting_ids</strong> (<em>optional</em> List[Int]) – The ids of settings that are held constant during optimization.
Also requires <cite>fixed_settings</cite> to be provided.</p></li>
<li><p><strong>fixed_settings</strong> (<em>optional</em> List[Float]) – The constant values for fixed settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D list of <code class="docutils literal notranslate"><span class="pre">qnp.tensor</span></code> scalar values having <code class="docutils literal notranslate"><span class="pre">requires_grad=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qnetvo.NetworkAnsatz.tf_rand_network_settings">
<span class="sig-name descname"><span class="pre">tf_rand_network_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fixed_setting_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qnetvo/network_ansatz.html#NetworkAnsatz.tf_rand_network_settings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qnetvo.NetworkAnsatz.tf_rand_network_settings" title="Permalink to this definition">#</a></dt>
<dd><p>Creates a randomized settings array for the network ansatz using TensorFlow
tensor types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fixed_setting_ids</strong> (<em>optional</em> List[Int]) – The ids of settings that are held constant during optimization.
Also requires <cite>fixed_settings</cite> to be provided.</p></li>
<li><p><strong>fixed_settings</strong> (<em>optional</em> List[Float]) – The constant values for fixed settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D list of <code class="docutils literal notranslate"><span class="pre">tf.Variable</span></code> and <code class="docutils literal notranslate"><span class="pre">tf.constant</span></code> scalar values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[tf.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qnetvo.NetworkAnsatz.zero_network_settings">
<span class="sig-name descname"><span class="pre">zero_network_settings</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qnetvo/network_ansatz.html#NetworkAnsatz.zero_network_settings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qnetvo.NetworkAnsatz.zero_network_settings" title="Permalink to this definition">#</a></dt>
<dd><p>Creates a settings array for the network ansatz that consists of zeros.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A 1D list of <code class="docutils literal notranslate"><span class="pre">np.tensor</span></code> scalar values having <code class="docutils literal notranslate"><span class="pre">requires_grad=True</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[Float]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="ansatz_library.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Ansatz Library</div>
              </div>
              <svg style="width:4em;"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="network_nodes.html">
              <svg style="width:4em;"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Network Nodes</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Brian Doolittle and Tom Bromley |
          Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> and the <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            | <a class="muted-link" href="../_sources/quantum_networks/network_ansatzes.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Network Ansatzes</a><ul>
<li><a class="reference internal" href="#qnetvo.NetworkAnsatz"><code class="docutils literal notranslate"><span class="pre">NetworkAnsatz</span></code></a><ul>
<li><a class="reference internal" href="#qnetvo.NetworkAnsatz.check_cc_causal_structure"><code class="docutils literal notranslate"><span class="pre">NetworkAnsatz.check_cc_causal_structure()</span></code></a></li>
<li><a class="reference internal" href="#qnetvo.NetworkAnsatz.circuit_layer_fn"><code class="docutils literal notranslate"><span class="pre">NetworkAnsatz.circuit_layer_fn()</span></code></a></li>
<li><a class="reference internal" href="#qnetvo.NetworkAnsatz.collect_wires"><code class="docutils literal notranslate"><span class="pre">NetworkAnsatz.collect_wires()</span></code></a></li>
<li><a class="reference internal" href="#qnetvo.NetworkAnsatz.expand_qnode_settings"><code class="docutils literal notranslate"><span class="pre">NetworkAnsatz.expand_qnode_settings()</span></code></a></li>
<li><a class="reference internal" href="#qnetvo.NetworkAnsatz.get_network_parameter_partitions"><code class="docutils literal notranslate"><span class="pre">NetworkAnsatz.get_network_parameter_partitions()</span></code></a></li>
<li><a class="reference internal" href="#qnetvo.NetworkAnsatz.layer_settings"><code class="docutils literal notranslate"><span class="pre">NetworkAnsatz.layer_settings()</span></code></a></li>
<li><a class="reference internal" href="#qnetvo.NetworkAnsatz.qnode_settings"><code class="docutils literal notranslate"><span class="pre">NetworkAnsatz.qnode_settings()</span></code></a></li>
<li><a class="reference internal" href="#qnetvo.NetworkAnsatz.rand_network_settings"><code class="docutils literal notranslate"><span class="pre">NetworkAnsatz.rand_network_settings()</span></code></a></li>
<li><a class="reference internal" href="#qnetvo.NetworkAnsatz.tf_rand_network_settings"><code class="docutils literal notranslate"><span class="pre">NetworkAnsatz.tf_rand_network_settings()</span></code></a></li>
<li><a class="reference internal" href="#qnetvo.NetworkAnsatz.zero_network_settings"><code class="docutils literal notranslate"><span class="pre">NetworkAnsatz.zero_network_settings()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=d86bf16a"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>